<!DOCTYPE html>
<html>
<head>
    <title>Telegram WebApp Debug</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            margin: 0;
            background-color: var(--tg-theme-bg-color, white);
            color: var(--tg-theme-text-color, black);
        }
        .button {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background-color: var(--tg-theme-button-color, #2481cc);
            color: var(--tg-theme-button-text-color, white);
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Telegram WebApp Debug</h1>
    
    <p>Это отладочная страница. Если вы видите эту страницу, HTML загружается корректно.</p>
    
    <button class="button" onclick="sendDebugInfo()">Отправить отладочную информацию</button>
    <button class="button" onclick="testNavigation()">Тест навигации</button>
    
    <script>
        // Инициализируем WebApp
        if (window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
            
            document.write('<p style="color:green">✓ Telegram WebApp инициализирован!</p>');
        } else {
            document.write('<p style="color:red">✗ Telegram WebApp не найден!</p>');
        }
        
        // Отправка отладочных данных
        function sendDebugInfo() {
            if (window.Telegram && window.Telegram.WebApp) {
                var debugInfo = {
                    type: 'DEBUG_INFO',
                    userAgent: navigator.userAgent,
                    viewportSize: {
                        width: window.innerWidth,
                        height: window.innerHeight
                    },
                    webAppParams: {
                        version: window.Telegram.WebApp.version,
                        viewportHeight: window.Telegram.WebApp.viewportHeight,
                        isExpanded: window.Telegram.WebApp.isExpanded,
                        colorScheme: window.Telegram.WebApp.colorScheme,
                        themeParams: window.Telegram.WebApp.themeParams,
                        initData: window.Telegram.WebApp.initData
                    }
                };
                
                // Отправляем данные в бота
                try {
                    window.Telegram.WebApp.sendData(JSON.stringify(debugInfo));
                    alert('Отладочная информация отправлена!');
                } catch(e) {
                    alert('Ошибка отправки данных: ' + e.message);
                }
            } else {
                alert('Telegram WebApp недоступен!');
            }
        }
        
        // Тест навигации с нижней панелью
        function testNavigation() {
            document.body.innerHTML = `
                <h1>Тест навигации</h1>
                <div id="content">
                    <p>Текущая страница: Главная</p>
                </div>
                <div style="position:fixed; bottom:0; left:0; right:0; display:flex; background:white; border-top:1px solid #ddd; height:60px;">
                    <button style="flex:1; border:none; background:none; color:blue;" onclick="changePage('home')">Главная</button>
                    <button style="flex:1; border:none; background:none;" onclick="changePage('search')">Поиск</button>
                    <button style="flex:1; border:none; background:none;" onclick="changePage('favorites')">Избранное</button>
                </div>
                <button style="position:fixed; top:10px; right:10px; padding:5px;" onclick="goBack()">Назад</button>
            `;
        }
        
        function changePage(page) {
            var content = document.getElementById('content');
            if (!content) return;
            
            switch(page) {
                case 'home':
                    content.innerHTML = '<p>Текущая страница: Главная</p>';
                    setActiveButton(0);
                    break;
                case 'search':
                    content.innerHTML = '<p>Текущая страница: Поиск</p><input type="text" placeholder="Поиск..." style="width:100%; padding:10px; margin-top:10px;">';
                    setActiveButton(1);
                    break;
                case 'favorites':
                    content.innerHTML = '<p>Текущая страница: Избранное</p><p>Ваши избранные фильмы будут здесь.</p>';
                    setActiveButton(2);
                    break;
            }
        }
        
        function setActiveButton(index) {
            var buttons = document.querySelectorAll('div[style*="position:fixed; bottom:0"] button');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].style.color = i === index ? 'blue' : '';
            }
        }
        
        function goBack() {
            window.location.reload();
        }
    </script>
</body>
</html>
